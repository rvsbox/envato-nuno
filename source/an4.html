<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>nuno</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"
            integrity="sha512-z4OUqw38qNLpn1libAN9BsoDx6nbNFio5lA6CuTp9NlK83b89hgyCVq+N5FdBJptINztxn1Z3SaKSKUS5UP60Q=="
            crossorigin="anonymous"></script>
</head>
<style>
    body {
        background-color: #1d1e22;
    }

    .buttons {
        margin: 50px 0 0 0;
    }

    .square {
        width: 50px;
        height: 50px;
        background-color: darkred;
    }
</style>
<body>

<div class="square"></div>

<div class="buttons">
    <button id="play">play</button>
    <button id="pause">pause</button>

    <input id="getsqx" type="button" value="get translateX">
    <input id="switch" type="button" value="animation switch">
</div>

<script>
    let animation = function () {

        let updates = 0
        // let loopBegan = 0
        // let loopCompleted = 0
        // let changeCompleted = 0

        let update = anime({
            targets: ".square",
            translateX: 270,
            delay: 1000,
            direction: "alternate",
            loop: true,
            easing: "easeInOutCirc",
            autoplay: true,
            update: function () {
                updates++
                getSqX() // получить расположение квадрата по оси 'x' на каждом этапе вызова

                if (!sqState && sqX == 0) {
                    update.pause()
                }

                // loopBegin: function(anim) {
                //     loopBegan++;
                //     console.log('begin: ' + loopBegan)
                // },
                // loopComplete: function(anim) {
                //     loopCompleted++;
                //     console.log('completed: ' + loopCompleted)
                // },
                // changeComplete: function () {
                //     if (changeCompleted === 0) {
                //         // console.log(changeCompleted)
                //         changeCompleted++
                //     } else {
                //         // console.log(changeCompleted)
                //         changeCompleted--
                //     }
                // }
            }
        })

        // document.getElementById('pause').addEventListener('click', function () {update.pause()})
        document.getElementById("pause").onclick = update.pause
        document.getElementById("play").onclick = update.play
    }

    animation()

    let sqX
    let sqState = true

    // получить расположение квадрата по оси 'x'
    function getSqX() {
        let squareTransform = document.querySelector('.square').style.transform
        sqX = squareTransform.replace(/[^\d.]/g, '')
        // console.log(sqX)
    }

    function sqSwitch() {
        sqState = !sqState
        console.log(sqState)
    }

    document.getElementById('getsqx').addEventListener('click', getSqX)
    document.getElementById('switch').addEventListener('click', sqSwitch)
    // document.querySelector("#play-pause-demo #play").onclick = animation.play
    // document.querySelector("#play-pause-demo #pause").onclick = animation.pause


    // function stop(){
    //     anime.set(".square", {
    //         translateX: function () {
    //             return anime.random(50, 250);
    //         },
    //         rotate: function () {
    //             return anime.random(0, 360);
    //         },
    //         loop: false
    //     });
    // }


    // update()

</script>
</body>
</html>